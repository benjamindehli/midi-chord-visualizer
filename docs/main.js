(()=>{"use strict";const e=[{number:0,name:"C"},{number:1,name:"C#"},{number:2,name:"D"},{number:3,name:"D#"},{number:4,name:"E"},{number:5,name:"F"},{number:6,name:"F#"},{number:7,name:"G"},{number:8,name:"G#"},{number:9,name:"A"},{number:10,name:"A#"},{number:11,name:"B"}],a={"":{halfSteps:[0],parsedHalfSteps:[0]},"m(add2)(no5)":{halfSteps:[0,2,3],parsedHalfSteps:[0,2,3]},"m(add2)":{halfSteps:[0,2,3,7],parsedHalfSteps:[0,2,3,7]},"add2(no5)":{halfSteps:[0,2,4],parsedHalfSteps:[0,2,4]},add2:{halfSteps:[0,2,4,7],parsedHalfSteps:[0,2,4,7]},sus2add4:{halfSteps:[0,2,5,7],parsedHalfSteps:[0,2,5,7]},sus2:{halfSteps:[0,2,7],parsedHalfSteps:[0,2,7]},"7sus2":{halfSteps:[0,2,7,10],parsedHalfSteps:[0,2,7,10]},maj7sus2:{halfSteps:[0,2,7,11],parsedHalfSteps:[0,2,7,11]},m3:{halfSteps:[0,3],parsedHalfSteps:[0,3]},"m7(add4)(no5)":{halfSteps:[0,3,5,10],parsedHalfSteps:[0,3,5,10]},"m7(add11)(no5)":{halfSteps:[0,3,10,17],parsedHalfSteps:[0,3,5,10]},"m7(add11)":{halfSteps:[0,3,5,7,10],parsedHalfSteps:[0,3,5,7,10]},dim:{halfSteps:[0,3,6],parsedHalfSteps:[0,3,6]},dim7:{halfSteps:[0,3,6,9],parsedHalfSteps:[0,3,6,9]},"m7(b5)":{halfSteps:[0,3,6,10],parsedHalfSteps:[0,3,6,10]},"m(maj7)(b5)":{halfSteps:[0,3,6,11],parsedHalfSteps:[0,3,6,11]},minor:{halfSteps:[0,3,7],parsedHalfSteps:[0,3,7]},m6:{halfSteps:[0,3,7,9],parsedHalfSteps:[0,3,7,9]},"m(6add9)":{halfSteps:[0,3,7,9,14],parsedHalfSteps:[0,2,3,7,9]},m7:{halfSteps:[0,3,7,10],parsedHalfSteps:[0,3,7,10]},"m7(b9)":{halfSteps:[0,3,7,10,13],parsedHalfSteps:[0,1,3,7,10]},m9:{halfSteps:[0,3,7,10,14],parsedHalfSteps:[0,2,3,7,10]},m11:{halfSteps:[0,3,7,10,14,17],parsedHalfSteps:[0,2,3,5,7,10]},m13:{halfSteps:[0,3,7,10,14,21],parsedHalfSteps:[0,2,3,7,9,10]},"m7(11)":{halfSteps:[0,3,7,10,17],parsedHalfSteps:[0,3,5,7,10]},"m(maj7)":{halfSteps:[0,3,7,11],parsedHalfSteps:[0,3,7,11]},"m(maj9)":{halfSteps:[0,3,7,11,14],parsedHalfSteps:[0,2,3,7,11]},"m(maj11)":{halfSteps:[0,3,7,11,14,17],parsedHalfSteps:[0,2,3,5,7,11]},"m(maj9)(#11)":{halfSteps:[0,3,7,11,14,18],parsedHalfSteps:[0,2,3,6,7,11]},"m(maj13)(#11)":{halfSteps:[0,3,7,11,14,18,21],parsedHalfSteps:[0,2,3,6,7,9,11]},"m(maj13)":{halfSteps:[0,3,7,11,14,21],parsedHalfSteps:[0,2,3,7,9,11]},"m(maj7)(#11)":{halfSteps:[0,3,7,11,18],parsedHalfSteps:[0,3,6,7,11]},"m(add9)":{halfSteps:[0,3,7,14],parsedHalfSteps:[0,2,3,7]},"m(add11)":{halfSteps:[0,3,7,17],parsedHalfSteps:[0,3,5,7]},"m(add13)":{halfSteps:[0,3,7,21],parsedHalfSteps:[0,3,7,9]},"m(#5)":{halfSteps:[0,3,8],parsedHalfSteps:[0,3,8]},"m7(#5)":{halfSteps:[0,3,8,10],parsedHalfSteps:[0,3,8,10]},"m(maj7)(#5)":{halfSteps:[0,3,8,11],parsedHalfSteps:[0,3,8,11]},"m7(no5)":{halfSteps:[0,3,10],parsedHalfSteps:[0,3,10]},"m(maj9)(no5)":{halfSteps:[0,3,11,14],parsedHalfSteps:[0,2,3,11]},"m(add9)(no5)":{halfSteps:[0,3,14],parsedHalfSteps:[0,2,3]},3:{halfSteps:[0,4],parsedHalfSteps:[0,4]},b5:{halfSteps:[0,4,6],parsedHalfSteps:[0,4,6]},"6(b5)":{halfSteps:[0,4,6,9],parsedHalfSteps:[0,4,6,9]},"7(b5)":{halfSteps:[0,4,6,10],parsedHalfSteps:[0,4,6,10]},"9(b5)":{halfSteps:[0,4,6,10,14],parsedHalfSteps:[0,2,4,6,10]},"maj7(b5)":{halfSteps:[0,4,6,11],parsedHalfSteps:[0,4,6,11]},major:{halfSteps:[0,4,7],parsedHalfSteps:[0,4,7]},6:{halfSteps:[0,4,7,9],parsedHalfSteps:[0,4,7,9]},"6add9":{halfSteps:[0,4,7,9,14],parsedHalfSteps:[0,2,4,7,9]},7:{halfSteps:[0,4,7,10],parsedHalfSteps:[0,4,7,10]},b9:{halfSteps:[0,4,7,10,13],parsedHalfSteps:[0,1,4,7,10]},"7(b9)(#9)":{halfSteps:[0,4,7,10,13,15],parsedHalfSteps:[0,1,3,4,7,10]},9:{halfSteps:[0,4,7,10,14],parsedHalfSteps:[0,2,4,7,10]},"9(#11)":{halfSteps:[0,4,7,10,14,18],parsedHalfSteps:[0,2,4,6,7,10]},"7(#9)":{halfSteps:[0,4,7,10,15],parsedHalfSteps:[0,3,4,7,10]},11:{halfSteps:[0,4,7,10,14,17],parsedHalfSteps:[0,2,4,5,7,10]},13:{halfSteps:[0,4,7,10,14,21],parsedHalfSteps:[0,2,4,7,9,10]},"7(#11)":{halfSteps:[0,4,7,10,18],parsedHalfSteps:[0,4,6,7,10]},"7(b13)":{halfSteps:[0,4,7,10,20],parsedHalfSteps:[0,4,7,8,10]},maj7:{halfSteps:[0,4,7,11],parsedHalfSteps:[0,4,7,11]},maj9:{halfSteps:[0,4,7,11,14],parsedHalfSteps:[0,2,4,7,11]},maj11:{halfSteps:[0,4,7,11,14,17],parsedHalfSteps:[0,2,4,5,7,11]},"maj9(#11)":{halfSteps:[0,4,7,11,14,18],parsedHalfSteps:[0,2,4,6,7,11]},"maj13(#11)":{halfSteps:[0,4,7,11,14,18,21],parsedHalfSteps:[0,2,4,6,7,9,11]},maj13:{halfSteps:[0,4,7,11,14,21],parsedHalfSteps:[0,2,4,7,9,11]},"maj7(#11)":{halfSteps:[0,4,7,11,18],parsedHalfSteps:[0,4,6,7,11]},maj7add13:{halfSteps:[0,4,7,11,21],parsedHalfSteps:[0,4,7,9,11]},add9:{halfSteps:[0,4,7,14],parsedHalfSteps:[0,2,4,7]},addb9:{halfSteps:[0,4,7,13],parsedHalfSteps:[0,1,4,7]},add11:{halfSteps:[0,4,7,17],parsedHalfSteps:[0,4,5,7]},add13:{halfSteps:[0,4,7,21],parsedHalfSteps:[0,4,7,9]},aug:{halfSteps:[0,4,8],parsedHalfSteps:[0,4,8]},"7(#5)":{halfSteps:[0,4,8,10],parsedHalfSteps:[0,4,8,10]},"9(#5)":{halfSteps:[0,4,8,10,14],parsedHalfSteps:[0,2,4,8,10]},"7alt":{halfSteps:[0,4,8,10,15],parsedHalfSteps:[0,3,4,8,10]},"maj7(#5)":{halfSteps:[0,4,8,11],parsedHalfSteps:[0,4,8,11]},"7(no5)":{halfSteps:[0,4,10],parsedHalfSteps:[0,4,10]},"7(#9)(no5)":{halfSteps:[0,4,10,15],parsedHalfSteps:[0,3,4,10]},"maj9(no5)":{halfSteps:[0,4,11,14],parsedHalfSteps:[0,2,4,11]},"add9(no5)":{halfSteps:[0,4,14],parsedHalfSteps:[0,2,4]},"sus4(b5)":{halfSteps:[0,5,6],parsedHalfSteps:[0,5,6]},"11(b5)sus4":{halfSteps:[0,5,6,10],parsedHalfSteps:[0,5,6,10]},"maj11(b5)sus4":{halfSteps:[0,5,6,11],parsedHalfSteps:[0,5,6,11]},sus4:{halfSteps:[0,5,7],parsedHalfSteps:[0,5,7]},"7sus4":{halfSteps:[0,5,7,10],parsedHalfSteps:[0,5,7,10]},"7sus4add13":{halfSteps:[0,5,7,10,21],parsedHalfSteps:[0,5,7,9,10]},"11sus4":{halfSteps:[0,5,10],parsedHalfSteps:[0,5,10]},"dim(no3)":{halfSteps:[0,6],parsedHalfSteps:[0,6]},"sus(#4)":{halfSteps:[0,6,7],parsedHalfSteps:[0,6,7]},"7(b5)sus":{halfSteps:[0,6,10],parsedHalfSteps:[0,6,10]},"maj7(b5)sus":{halfSteps:[0,6,11],parsedHalfSteps:[0,6,11]},5:{halfSteps:[0,7],parsedHalfSteps:[0,7]},"6sus":{halfSteps:[0,7,9],parsedHalfSteps:[0,7,9]},"7sus":{halfSteps:[0,7,10],parsedHalfSteps:[0,7,10]},"9sus2":{halfSteps:[0,7,10,14],parsedHalfSteps:[0,2,7,10]},maj7sus:{halfSteps:[0,7,11],parsedHalfSteps:[0,7,11]},maj9sus2:{halfSteps:[0,7,11,14],parsedHalfSteps:[0,2,7,11]},"5(add9)":{halfSteps:[0,7,14],parsedHalfSteps:[0,2,7]},"7(no3)":{halfSteps:[0,10],parsedHalfSteps:[0,10]},"maj7(no3)":{halfSteps:[0,11],parsedHalfSteps:[0,11]}};function s(e){return e%12}function t(t,p){return e.forEach(e=>{const l=t.map(a=>function(e,a){let s=e-a;return s<0&&(s+=12),s}(a,e.number));l.sort((e,a)=>e-a);const f=[...new Set(l.map(s))].sort((e,a)=>e-a);for(const[s,t]of Object.entries(a)){const a=t.parsedHalfSteps;if(f.length!==a.length)continue;let l=!0;for(let e=0;e<a.length;e++)if(f[e]!==a[e]){l=!1;break}l&&p.push({root:e.name,chord:s})}}),p}function p(e,a){const s=document.createElement("div");return s.classList.add("key"),s.dataset.note=e,s.dataset.octave=a,s.classList.add(function(e){return[0,2,4,5,7,9,11].includes(e)?"white":"black"}(e)),s}function l(e){document.querySelectorAll(".key").forEach(e=>e.classList.remove("active")),e.forEach(e=>function(e){const a=`.key[data-note='${e%12}'][data-octave='${Math.floor(e/12)}']`,s=document.querySelector(a);s&&s.classList.add("active")}(e))}navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(function(e){console.log("MIDI ready!");for(const a of e.inputs.values())console.log(`Connected to: ${a.name}`),a.onmidimessage=d;e.onstatechange=e=>{console.log(`MIDI device ${e.port.name} ${e.port.state}`)}},function(){console.error("Could not access your MIDI devices.")}):console.error("Web MIDI API is not supported in this browser.");const f=new Set;function d(e){const[a,s,t]=e.data;144===a&&t>0?(f.add(s),r(),l(Array.from(f))):(128===a||144===a&&0===t)&&(f.delete(s),r(),l(Array.from(f)))}function r(){f.forEach(e=>{document.createElement("li").textContent=`Note: ${e}`});const a=function(a){let p=[];if(0===a.length)return p;const l=s(Math.min(...a)),f=e.find(e=>e.number===l).name;p=t(a,p);const d=function(e,a){return e.find(e=>e.root===a)}(p,f);if(d)return function(e,a){return(e=e.filter(e=>e!==a)).unshift(a),e}(p,d);{const e=[...a].sort((e,a)=>e-a),s=e[0];let l=[...e];for(;l.length>0&&l[0]===s;)l.shift();return[...t(l,[]).map(e=>({root:e.root,chord:`${e.chord} / ${f}`})),...p]}}(Array.from(f)),p=document.getElementById("matched-chords-list");p&&(p.innerHTML="",a.forEach(({root:e,chord:a})=>{const s=document.createElement("li"),t=document.createElement("span");t.textContent=`${e} ${a}`,s.appendChild(t),p.appendChild(s)}))}document.addEventListener("DOMContentLoaded",()=>{!function(e=2){const a=document.getElementById("keyboard");a.innerHTML="";for(let s=0;s<e;s++)for(let e=0;e<12;e++){const t=p(e,s);a.appendChild(t)}}(8)}),document.addEventListener("keydown",e=>{n(e.key)}),document.addEventListener("keyup",e=>{n(e.key)});const S={a:60,w:61,s:62,e:63,d:64,f:65,t:66,g:67,y:68,h:69,u:70,j:71,k:72};function n(e){const a=S[e];a&&(f.has(a)?f.delete(a):f.add(a),r(),l(Array.from(f)))}})();